<?xml version="1.0" encoding="ISO-8859-1" ?>
<interface id="ming_test" version="release_8">
    <!-- View definitions -->
    <download>
        <source type="folder" name="clusterinfo/"/>
        <source type="folder" name="clusterinfogroup/"/>
        <source type="folder" name="clusterinfosummarygroup_attributes_withIDs_withcomponentID/"/>
        <source type="folder" name="networkedges_selfloop/"/>
        <source type="folder" name="result_specnets_DB/"/>
        <source type="folder" name="groupmapping_converted/"/>
        <source type="folder" name="qiime2_output/"/>
        <source type="folder" name="gnps_molecular_network_graphml/"/>
    </download>

    <view id="view_all_annotations_DB" label="View All Library Hits" group="Default Molecular Networking Results Views">
        <blockRef id="main" type="view_all_annotations_DB"/>
    </view>
    <block id="view_all_annotations_DB" type="table">
        <data>
            <source type="file" name="result_specnets_DB/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="MQScore" operator="descending"/>
            </parsers>
            <processors>
                <processor type="uploadFilename" field="SpectrumFile"/>
            </processors>
        </data>
        <row>
            <column label="ViewLib" type="genericurlgenerator" width="5">
                <parameter name="URLBASE" value="/ProteoSAFe/gnpslibraryspectrum.jsp"/>
                <parameter name="REQUESTPARAMETER=SpectrumID" value="[SpectrumID]"/>
                <parameter name="LABEL" value="ViewLib"/>
            </column>
            <column label="Explore" type="genericurlgenerator" width="5">
                <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>
                <parameter name="REQUESTPARAMETER=task" value="698fc5a09db74c7492983b3673ff5bf6"/>
                <parameter name="REQUESTPARAMETER=view" value="molecule_explorer_v2_details"/>
                <parameter name="REQUESTPARAMETER=show" value="true"/>
                <parameter name="HASHPARAMTER=main.compound_name_input" value="[Compound_Name]||EXACT"/>
                <parameter name="LABEL" value="Explore Molecule in [MoleculeExplorerFiles] Files and [MoleculeExplorerDatasets] Datasets"/>
            </column>
            <column type="text" field="Compound_Name" label="Compound_Name" width="12"/>
            <column type="integer" field="#Scan#" label="ClusterIdx" width="3"/>
            <column label="View All Spectra" type="genericurlgenerator" width="10">
                <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>
                <parameter name="REQUESTPARAMETER=view" value="cluster_details"/>
                <parameter name="REQUESTPARAMETER=protein" value="[#Scan#]"/>
                <parameter name="REQUESTPARAMETER=show" value="true"/>
                <parameter name="LABEL" value="View Raw Spectra"/>
                <parameter name="USETASK" value="True"/>
            </column>
            <column type="text" field="LibraryQualityString" label="Library Class" width="5"/>

            <column type="float" field="MQScore" label="Cosine" precision="2"/>
            <column type="integer" field="SharedPeaks" label="SharedPeaks" width="3"/>
            <column type="float" field="TIC_Query" label="TIC Query" precision="2"/>
            <column type="float" field="RT_Query" label="RT Query" precision="2" />
            <column type="integer" field="MZErrorPPM" label="MZErrorPPM" />

            <column type="float" field="MassDiff" label="MassDiff" precision="2"/>
            <column type="float" field="SpecMZ" label="SpecMZ" precision="2"/>
            <column type="float" field="LibMZ" label="LibMZ" precision="2"/>

            <column type="text" field="Instrument" label="Instrument" width="5"/>
            <columbiomn type="text" field="IonMode" label="IonMode" width="5"/>
            <column type="text" field="PI" label="PI" width="5"/>
            <column type="text" field="Ion_Source" label="Ion Source" width="5"/>
            <column type="text" field="tags" label="Tags" width="5"/>
            <column label="Add Library Tag" type="addspectrumtag" width="12">
                <parameter name="spectrumID" value="[SpectrumID]"/>
            </column>
            <column type="structuredisplayer" label="Structure">
                <parameter name="smilesstructure" value="[Smiles]"/>
            </column>
        </row>
        <row expander="image">
            <column type="jscolumnspectrumviewer" colspan="5" label="Query" width="550" height="350">
                <parameter name="file" file="spectra/specs_ms.mgf"/>
                <parameter name="scan" value="[#Scan#]"/>
                <parameter name="compoundname" value="*..*"/>
            </column>
            <column type="jscolumnspectrumviewer" colspan="5" label="Library" width="550" height="350">
                <parameter name="file" file="lib/[LibraryName]"/>
                <parameter name="spectrumid" value="[SpectrumID]"/>
                <parameter name="compoundname" value="*..*"/>
            </column>
        </row>
        <row expander="View Mirror Match" expandericontype="text">
            <column type="jscolumnspectrumviewer_spectrum_comparison" colspan="5">
                <parameter name="spectrum1_type" value="flatfile"/>
                <parameter name="spectrum1_file" file="spectra/specs_ms.mgf"/>
                <parameter name="spectrum1_scan" value="[#Scan#]"/>
                <parameter name="spectrum2_type" value="lib"/>
                <parameter name="spectrum2_spectrumid" value="[SpectrumID]"/>
            </column>
        </row>
        <row expander="USI Links" expandericontype="text">
            <column label="USI-Spectrum" type="genericurlgenerator" width="3"> \
                <parameter name="URLBASE" value="https://metabolomics-usi.ucsd.edu/mirror/"/>\
                <parameter name="REQUESTPARAMETER=usi1" value="mzspec:GNPSTASK-{task}:spectra/specs_ms.mgf:scan:[#Scan#]"/>
                <parameter name="REQUESTPARAMETER=usi2" value="mzspec:GNPSLIBRARY:[SpectrumID]"/>
                <parameter name="LABEL" value="Mirror Match USI"/>
            </column>
            <column label="USI-Spectrum" type="genericurlgenerator" width="3"> \
                <parameter name="URLBASE" value="https://metabolomics-usi.ucsd.edu/spectrum/"/>\
                <parameter name="REQUESTPARAMETER=usi" value="mzspec:GNPSTASK-{task}:spectra/specs_ms.mgf:scan:[#Scan#]"/>
                <parameter name="LABEL" value="Query Spectrum USI"/>
            </column>
            <column label="USI-Library" type="genericurlgenerator" width="3"> \
                <parameter name="URLBASE" value="https://metabolomics-usi.ucsd.edu/spectrum/"/>\
                <parameter name="REQUESTPARAMETER=usi" value="mzspec:GNPSLIBRARY:[SpectrumID]"/>
                <parameter name="LABEL" value="Library Spectrum USI"/>
            </column>
        </row>


        
        
    </block>

    <view id="group_by_compound" label="View Unique Library Compounds" group="Default Molecular Networking Results Views">
        <blockRef id="main" type="group_by_compound"/>
    </view>

    <block id="group_by_compound" type="table">
        <data>
            <source type="file" name="result_specnets_DB/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="MQScore" operator="descending"/>
                <parser type="representativeTabular" groupBy="Compound_Name" selectBy="MQScore" operator="max"/>
            </parsers>
            <processors>
                <processor type="uploadFilename" field="SpectrumFile"/>
            </processors>
        </data>
        <row>
            <column label="ViewLib" type="genericurlgenerator" width="5">
                <parameter name="URLBASE" value="/ProteoSAFe/gnpslibraryspectrum.jsp"/>
                <parameter name="REQUESTPARAMETER=SpectrumID" value="[SpectrumID]"/>
                <parameter name="LABEL" value="ViewLib"/>
            </column>

            <column type="text" field="Compound_Name" label="Compound_Name" width="12"/>
            <column type="text" field="LibraryQualityString" label="Library Class" width="5"/>
            <column type="float" field="MQScore" label="Cosine" precision="2"/>
            <column type="integer" field="MZErrorPPM" label="MZErrorPPM" />
            <column type="float" field="MassDiff" label="MassDiff" precision="3"/>
            <column type="float" field="LibMZ" label="LibMZ" precision="2"/>
            <column type="text" field="Instrument" label="Instrument" width="5"/>
            <column type="text" field="IonMode" label="IonMode" width="5"/>
            <column type="text" field="PI" label="PI" width="5"/>
            <column type="text" field="Ion_Source" label="Ion Source" width="5"/>
            <column type="text" field="tags" label="Tags" width="5"/>
            <column label="Add Library Tag" type="addspectrumtag" width="12">
                <parameter name="spectrumID" value="[SpectrumID]"/>
            </column>
            <column type="structuredisplayer" label="Structure">
                <parameter name="smilesstructure" value="[Smiles]"/>
            </column>
        </row>
        <row expander="image">
            <column type="jscolumnspectrumviewer" colspan="5" label="Query" width="550" height="350">
                <parameter name="file" file="spectra/[internalFilename]"/>
                <parameter name="scan" value="[#Scan#]"/>
                <parameter name="compoundname" value="*..*"/>
                <parameter name="trim" value="true"/>
            </column>
            <column type="jscolumnspectrumviewer" colspan="5" label="Library" width="550" height="350">
                <parameter name="file" file="lib/[LibraryName]"/>
                <parameter name="spectrumid" value="[SpectrumID]"/>
                <parameter name="compoundname" value="*..*"/>
                <parameter name="trim" value="true"/>
            </column>
        </row>
    </block>

    <view id="view_all_clusters_withID_beta" label="View All Clusters With IDs" group="Default Molecular Networking Results Views">
        <blockRef id="main" type="view_all_clusters_withID_beta"/>
    </view>
    <block id="view_all_clusters_withID_beta" type="table">
        <data>
            <source type="file" name="clusterinfosummarygroup_attributes_withIDs_withcomponentID/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="cluster index" operator="ascending"/>
            </parsers>
        </data>
        <row>
            <column label="ClusterIdx" type="genericurlgenerator" width="10" field="cluster index">
                <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>
                <parameter name="REQUESTPARAMETER=view" value="cluster_details"/>
                <parameter name="REQUESTPARAMETER=protein" value="[cluster index]"/>
                <parameter name="REQUESTPARAMETER=show" value="true"/>
                <parameter name="LABEL" value="Cluster - [cluster index]"/>
                <parameter name="USETASK" value="True"/>
            </column>
            <column label="Spec Family" type="genericurlgenerator" width="10" field="componentindex"> \
                <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>
                <parameter name="REQUESTPARAMETER=view" value="network_displayer"/>
                <parameter name="REQUESTPARAMETER=componentindex" value="[componentindex]"/>
                <parameter name="REQUESTPARAMETER=highlight_node" value="[cluster index]"/>
                <parameter name="LABEL" value="View Network"/>
                <parameter name="USETASK" value="True"/>
                <parameter name="IGNORE_VALUE" value="-1"/>
                <parameter name="VALUE_TO_CONSIDER" value="[componentindex]"/>
            </column>

            <column type="parameterlink" target="result.jsp" label="AnnotatetoGNPS" includetask="true">
                <parameter name="view" value="cluster_details"/>
                <parameter name="protein" value="[cluster index]"/>
            </column>

            <column type="parameterlink" target="result.jsp" label="AddtoChallenge" includetask="true">
                <parameter name="view" value="cluster_details"/>
                <parameter name="protein" value="[cluster index]"/>
            </column>

            <column type="integer" field="number of spectra" label="NumSpectra" width="3"/>
            <column type="integer" field="UniqueFileSourcesCount" label="NumFiles" width="3"/>
            <column type="float" field="precursor mass" label="PrecursorMZ" precision="5"/>
            <column type="float" field="sum(precursor intensity)" label="PrecursorInt" precision="5"/>
            <column type="float" field="RTMean" label="RTMean" width="3"/>
            <column type="text" field="AllGroups" label="AllGroups" width="3"/>
            <column type="text" field="DefaultGroups" label="DefaultGroups" width="5"/>
            <column type="integer" field="EvenOdd" label="EvenOdd" width="5"/>
            <column type="text" field="LibraryID" label="LibraryID" width="20"/>
            <column type="integer" field="NumberOrganismIDs" label="Hits" width="1"/>

            <column type="expandable" field="UniqueFileSources" label="All Files" width="20"/>
        </row>
        <row expander="image">
            <column type="jscolumnspectrumviewer" colspan="5">
                <parameter name="file" file="spectra/specs_ms.mgf"/>
                <parameter name="scan" value="[cluster index]"/>
                <parameter name="compoundname" value="[LibraryID]"/>
                <parameter name="trim" value="true"/>
            </column>
        </row>
        <row expander="View Analogs" expandericontype="text">
            <column type="block" block="related_network_list_specnets" colspan="7">
                <parameter name="spectraid" value="[cluster index]"/>
            </column>
        </row>
        <row expander="MASST Spectrum" expandericontype="text">
            <column type="singlespectrumcolumnhandler" colspan="5">
                <parameter name="mz" value="[precursor mass]"/>
                <parameter name="file" file="spectra/specs_ms.mgf"/>
                <parameter name="scan" value="[cluster index]"/>
            </column>
        </row>
        <row expander="USI Links" expandericontype="text">
            <column label="USI-Spectrum" type="genericurlgenerator" width="3" field="cluster index"> \
                <parameter name="URLBASE" value="https://metabolomics-usi.ucsd.edu/spectrum/"/>\
                <parameter name="REQUESTPARAMETER=usi" value="mzspec:GNPSTASK-{task}:spectra/specs_ms.mgf:scan:[cluster index]"/>
                <parameter name="LABEL" value="Spectrum USI"/>
            </column>
        </row>
    </block>



    <view id="network_components" label="View Spectral Families (In Browser Network Visualizer)" group="Network Visualizations">
        <blockRef id="main" type="network_components"/>
    </view>
    <block id="network_components" type="table">
        <data>
            <source type="file" name="networkcomponents/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="NodeCount" operator="descending"/>
            </parsers>
        </data>
        <row>
            <column label="Visualize Network" type="genericurlgenerator" width="12" field="ComponentIndex"> \
                <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>
                <parameter name="REQUESTPARAMETER=view" value="network_displayer"/>
                <parameter name="REQUESTPARAMETER=componentindex" value="[ComponentIndex]"/>
                <parameter name="LABEL" value="Visualize Network"/>
                <parameter name="USETASK" value="True"/>
            </column>\

            <column label="View Network Nodes" type="genericurlgenerator" width="12" field="ComponentIndex"> \
                <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>
                <parameter name="REQUESTPARAMETER=view" value="cluster_info_sliced"/>
                <parameter name="REQUESTPARAMETER=componentindex" value="[ComponentIndex]"/>
                <parameter name="REQUESTPARAMETER=show" value="true"/>
                <parameter name="LABEL" value="Network Nodes"/>
                <parameter name="USETASK" value="True"/>
            </column>

            <column type="integer" field="NodeCount" label="NodeCount" width="5"/>
            <column type="float" field="%ID" label="%ID" precision="3" />
            <column type="integer" field="#Spectra" label="#Spectra" width="5"/>
            <column type="expandable" field="AllIDs" label="AllIDs" width="10"/>
            <column type="expandable" field="DefaultGroups" label="DefaultGroups" width="10"/>
            <column type="expandable" field="UserGroups" label="UserGroups" width="10"/>
        </row>
    </block>

    <view id="pairs_histogram" label="Network Summarizing Graphs" group="Network Visualizations">
        <blockRef id="main" type="pairs_histogram"/>
    </view>
    <block id="pairs_histogram" type="chartdisplayer">
        <data>
            <source type="file" name="result/"/>
            <parsers>
                <parser type="stream" contentType="text/plain"/>
            </parsers>
        </data>
    </block>

    <view id="written_description" label="Workflow Written Description" group="Methods and Citation for Manuscripts">
        <blockRef id="main" type="written_description"/>
    </view>
    <block id="written_description" type="stream">
        <data>
            <source type="file" name="written_description/"/>
            <parsers>
                <parser type="stream" contentType="text/html"/>
            </parsers>
        </data>
    </block>

    <view id="download_clustered_spectra" label="Download Clustered Spectra as MGF" group="Export/Download Network Files">
        <blockRef id="main" type="download_clustered_spectra"/>
    </view>
    <block id="download_clustered_spectra" type="dummydownload">
        <data>
            <source type="file" name="spectra/specs_ms.mgf"/>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
    </block>

    <view id="download_cytoscape_data" label="Download GraphML for Cytoscape" group="Export/Download Network Files">
        <blockRef id="main" type="download_cytoscape_data"/>
    </view>
    <block id="download_cytoscape_data" type="dummydownload">
        <data>
            <source type="file" name="gnps_molecular_network_graphml/"/>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
    </block>





    <!-- Quantification Vizualization -->
    <view id="download_cluster_buckettable" label="Download Bucket Table" group="Export/Download Network Files">
        <blockRef id="main" type="download_cluster_buckettable"/>
    </view>


    <block id="download_cluster_buckettable" type="dummydownload">
        <data>
            <source type="file" name="cluster_buckets/"/>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
    </block>

    <view id="download_biom" label="Download BioM For Qiime/Qiita" group="Export/Download Network Files">
        <blockRef id="main" type="download_biom"/>
    </view>
    <block id="download_biom" type="dummydownload">
        <data>
            <source type="file" name="biom_output/"/>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
    </block>

    <view id="download_metadata" label="Download Metadata For Qiime" group="Export/Download Network Files">
        <blockRef id="main" type="download_metadata"/>
    </view>
    <block id="download_metadata" type="dummydownload">
        <data>
            <source type="file" name="metadata_for_qiime/"/>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
    </block>

    <!-- Ili Output -->
    <view id="download_ili_abundance" label="Download ili Data" group="Export/Download Network Files">
        <blockRef id="main" type="download_ili_abundance"/>
    </view>
    <block id="download_ili_abundance" type="dummydownload">
        <data>
            <source type="file" name="ili_output/"/>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
    </block>








    <view id="view_all_datasets_matched" label="View Matches to All Public Datasets" group="Advanced Views - Global Public Dataset Matches">
        <blockRef id="main" type="view_all_datasets_matched"/>
    </view>

    <block id="view_all_datasets_matched" type="table">
        <data>
            <source type="file" name="all_dataset_matches/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="score" operator="descending"/>
            </parsers>
        </data>
        <row>
            <column type="text" field="specs_filename" label="specs_filename" width="10"/>
            <column type="text" field="specs_scan" label="specs_scan" width="10"/>
            <column type="text" field="dataset_id" label="dataset_id" width="30"/>
            <column type="text" field="dataset_title" label="dataset_title" width="40"/>
            <column type="float" field="score" label="score" precision="2"/>
            <column type="text" field="Compound_Name" label="Compound_Name" width="10"/>
            <column type="integer" field="dataset_neighbors" label="dataset_neighbors" precision="2"/>
        </row>
        <row expander="image">
            <column type="jscolumnspectrumviewer_spectrum_comparison" colspan="5">
                <parameter name="spectrum1_type" value="flatfile"/>
                <parameter name="spectrum1_file" file="spectra/[specs_filename]"/>
>
                <parameter name="spectrum1_scan" value="[specs_scan]"/>
                <parameter name="spectrum2_type" value="flatfile"/>
                <parameter name="spectrum2_file" value="FILE->../../../../../../../../data/ccms-data/uploads/[dataset_filename]"/>
                <parameter name="spectrum2_scan" value="[dataset_scan]"/>
            </column>
        </row>
    </block>


    <view id="view_ili" label="View ili in GNPS" group="Advanced Views - Third Party Visualization">
        <blockRef id="main" type="view_ili"/>
    </view>
    <block id="view_ili" type="streamhtmlframe">
        <data>
            <source type="file" name="view_ili/"/>
            <parsers>
                <parser type="stream" contentType="text/html"/>
            </parsers>
        </data>
    </block>
















































    <view id="view_mz_histogram" label="Nodes, MZ Histogram" group="Advanced Views - Networking Graphs/Histograms">
        <blockRef id="main" type="view_mz_histogram"/>
    </view>

    <block id="view_mz_histogram" type="histogramdisplayer" viewname="view_all_clusters_withID_beta" columnname="parent mass">
        <data>
            <source type="file" name="all_network_paths_histogram/"/>
            <parsers>
                <parser type="stream" contentType="text/plain"/>
            </parsers>
        </data>
    </block>

    <view id="view_edges_delta_histogram" label="Edges, MZ Delta Histogram" group="Advanced Views - Networking Graphs/Histograms">
        <blockRef id="main" type="view_edges_delta_histogram"/>
    </view>

    <block id="view_edges_delta_histogram" type="histogramdisplayer" viewname="view_network_pairs" columnname="MzDiff">
        <data>
            <source type="file" name="all_network_paths_histogram/"/>
            <parsers>
                <parser type="stream" contentType="text/plain"/>
            </parsers>
        </data>
    </block>

    <view id="view_scatter_edge_score_to_delta" label="Edges, Score vs MZ Delta Plot" group="Advanced Views - Networking Graphs/Histograms">
        <blockRef id="main" type="view_scatter_edge_score_to_delta"/>
    </view>

    <block id="view_scatter_edge_score_to_delta" type="scatterplotdisplayer" viewname="view_network_pairs" xname="MzDiff" yname="Cos_Score">
        <data>
            <source type="file" name="all_network_paths_histogram/"/>
            <parsers>
                <parser type="stream" contentType="text/plain"/>
            </parsers>
        </data>
    </block>

    <view id="view_ppm_error_search_histogram" label="Library Search, PPM Error Histogram" group="Advanced Views - Networking Graphs/Histograms">
        <blockRef id="main" type="view_ppm_error_search_histogram"/>
    </view>

    <block id="view_ppm_error_search_histogram" type="histogramdisplayer" viewname="view_all_annotations_DB" columnname="MZErrorPPM">
        <data>
            <source type="file" name="all_network_paths_histogram/"/>
            <parsers>
                <parser type="stream" contentType="text/plain"/>
            </parsers>
        </data>
    </block>




    <view id="group_by_organism_DB" label="Group by Organism DB" display="hidden">
        <blockRef id="main" type="organism_list_DB"/>
    </view>

    <view id="organism_details_DB" display="hidden">
        <blockRef id="main" type="spectra_per_organism_DB"/>
    </view>

    <view id="group_by_spectrum_specnets" label="Group by Spectrum Specnets" display="hidden">
        <blockRef id="main" type="spectrum_list_specnets"/>
    </view>

    <view id="view_all_clusters" label="View All Clusters" display="hidden">
        <blockRef id="main" type="clusters_list_specnets"/>
    </view>





    <view id="view_network" label="View Network, Node Centric" group="Advanced Views - Misc Views">
        <blockRef id="main" type="network_list_specnets"/>
    </view>


    <view id="view_network_pairs" label="View Network Pairs" group="Advanced Views - Misc Views">
        <blockRef id="main" type="network_pairs_specnets"/>
    </view>
    <block id="network_pairs_specnets" type="table">
        <data>
            <source type="file" name="networkedges_display_pairs/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="Node1" operator="ascending"/>
            </parsers>
        </data>
        <row>
            <column type="integer" field="Node1" label="Node1" width="10"/>
            <column type="integer" field="Node2" label="Node2" width="10"/>
            <column type="float" field="Cos_Score" label="Cosine Score" precision="5" />
            <column type="float" field="MzDiff" label="MzDiff" precision="5"/>
        </row>
        <row expander="image">
            <column type="jscolumnspectrumviewer" colspan="5">
                <parameter name="file" file="[FileName]"/>
                <parameter name="scan" value="[Node1]"/>
                <parameter name="peptide" value="*..*"/>
            </column>
            <column type="jscolumnspectrumviewer" colspan="5">
                <parameter name="file" file="[FileName]"/>
                <parameter name="scan" value="[Node2]"/>
                <parameter name="peptide" value="*..*"/>
            </column>
            <column type="jscolumnspectrumviewer_spectrum_comparison" colspan="5">
                <parameter name="spectrum1_type" value="flatfile"/>
                <parameter name="spectrum1_file" file="[FileName]"/>
                <parameter name="spectrum1_scan" value="[Node1]"/>
                <parameter name="spectrum2_type" value="flatfile"/>
                <parameter name="spectrum2_file" file="[FileName]"/>
                <parameter name="spectrum2_scan" value="[Node2]"/>
            </column>
        </row>
    </block>

    <view id="network_statistics" label="Networking Statistics" group="Advanced Views - Misc Views">
        <blockRef id="main" type="network_statistics"/>
    </view>
    <block id="network_statistics" type="stream" panelHeight="600px">
        <data>
            <source type="file" name="network_statistics/"/>
            <parsers>
                <parser type="stream" contentType="text/plain"/>
            </parsers>
        </data>
    </block>


    <view id="view_raw_spectra" label="View Raw/Unclustered Spectra" group="Advanced Views - Misc Views">
        <blockRef id="main" type="view_raw_spectra"/>
    </view>

    <block id="view_raw_spectra" type="table">
        <data>
            <source type="file" name="allclustered_spectra_info_withpath/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="cluster index" operator="ascending"/>
            </parsers>
            <processors>
                <processor type="uploadFilename" field="AllFiles"/>
            </processors>
        </data>
        <row>
            <column type="integer" field="cluster index" label="ClusterIndex" width="3"/>
            <column type="text" field="AllFiles" label="Filename" width="10"/>
            <column type="integer" field="ScanNumber" label="Scan" width="3"/>
            <column type="float" field="sum(precursor intensity)" label="Precursor Int" precision="3"/>
            <column type="float" field="RTMean" label="RT" precision="3"/>
            <column type="float" field="parent mass" label="Parent Mass" precision="3"/>
        </row>
        <row expander="image">
            <column type="jscolumnspectrumviewer" colspan="5">
                <parameter name="file" file="[ProteosafeFilePath]"/>
                <parameter name="scan" value="[ScanNumber]"/>
                <parameter name="peptide" value="*..*"/>
            </column>
        </row>
    </block>



















    <view id="cluster_details" display="hidden">
        <blockRef id="main" type="results_per_cluster"/>
    </view>

    <view id="view_related_network" display="hidden">
        <blockRef id="main" type="related_network_list_specnets"/>
    </view>




    <view id="makedatasetdocumentation" label="Make Public Dataset Documentation" group="Advanced Views - Make Dataset Public">
        <blockRef id="main" type="makedatasetdocumentation"/>
    </view>
    <block id="makedatasetdocumentation" type="dummylinkout">
        <data>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
        <parameter name="URLBASE" value="https://ccms-ucsd.github.io/GNPSDocumentation/datasets/"/>
    </block>

    <view id="linkout" label="Make Dataset Public Direct Link" group="Advanced Views - Make Dataset Public">
        <blockRef id="main" type="linkout"/>
    </view>

    <block id="linkout" type="table">
        <data>
            <source type="file" name="linkout_file/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="filenames" operator="ascending"/>
            </parsers>
        </data>
        <row>
            <column label="Reananlyze" type="genericurlgenerator" width="5">
                <parameter name="URLBASE" value="https://massive.ucsd.edu/ProteoSAFe/index.jsp"/>
                <parameter name="HASHPARAMTER=workflow" value="MASSIVE-COMPLETE"/>
                <parameter name="HASHPARAMTER=desc" value="GNPS - Dataset Creation from GNPS Molcular Networking - [task]"/>
                <parameter name="HASHPARAMTER=peak_list_files" value="[filenames]"/>
                <parameter name="HASHPARAMTER=other_files" value="[metadatanames]"/>
                <parameter name="LABEL" value="MassIVE Dataset Deposition Workflow (Prepopulated)"/>
            </column>
        </row>
    </block>

    <!-- <view id="makedatasetlink" label="Make this data into Dataset at MassIVE" group="Advanced Views - Make Dataset Public">
                <blockRef id="main" type="makedatasetlink"/>
        </view>
        <block id="makedatasetlink" type="dummylinkout">
          <data>
             <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
          </data>
            <parameter name="URLBASE" value='https://massive.ucsd.edu/ProteoSAFe/?params={"workflow":"MASSIVE-COMPLETE", "dataset.comments":"Dataset of Molecular Network from GNPS [task]", "peak_list_files":"d.[task]/spec;d.[task]/spectwo;d.[task]/specthree;", "other_files":"f.[task]/spectra/specs_ms.mgf;d.[task]/gnps_molecular_network_graphml;"}'/>
        </block> -->


    <view id="view_spectrum" display="hidden">
        <blockRef id="main" type="view_spectrum"/>
    </view>


    <block id="view_spectrum" type="spectrumpage">
        <data>
            <source type="file" name="result/"/>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
    </block>



    <view id="view_all_annotations_legacy" label="View All Library Hits" display="hidden">
        <blockRef id="main" type="view_all_annotations_legacy"/>
    </view>

    <block id="view_all_annotations_legacy" type="table">
        <data>
            <source type="file" name="result_specnets/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="MQScore" operator="descending"/>
            </parsers>
        </data>
        <row>
            <column type="text" field="CompoundName" label="Compound_Name" width="12"/>
            <column type="integer" field="#Scan#" label="ClusterIdx" width="3"/>
            <column type="float" field="MQScore" label="Cosine" precision="2"/>
            <column type="integer" field="SharedPeaks" label="SharedPeaks" width="3"/>
            <column type="float" field="TIC_Query" label="TIC Query" precision="2"/>
            <column type="float" field="RT_Query" label="RT Query" precision="2" />
            <column type="integer" field="MZErrorPPM" label="MZErrorPPM" />

            <column type="float" field="MassDiff" label="MassDiff" precision="2"/>
            <column type="float" field="SpecMZ" label="SpecMZ" precision="2"/>
            <column type="float" field="LibMZ" label="LibMZ" precision="2"/>

            <column type="text" field="Instrument" label="Instrument" width="5"/>
            <columbiomn type="text" field="IonMode" label="IonMode" width="5"/>
            <column type="text" field="PI" label="PI" width="5"/>
            <column type="text" field="Ion_Source" label="Ion Source" width="5"/>
            <column type="text" field="tags" label="Tags" width="5"/>
        </row>
        <row expander="image">
            <column type="jscolumnspectrumviewer_spectrum_comparison" colspan="5">
                <parameter name="spectrum1_type" value="flatfile"/>
                <!-- <parameter name="spectrum1_file" file="spectra/[internalFilename]"/>> -->
                <parameter name="spectrum1_file" file="spectra/specs_ms.mgf"/>
>
                <parameter name="spectrum1_scan" value="[#Scan#]"/>
                <parameter name="spectrum2_type" value="lib"/>
                <parameter name="spectrum2_spectrumid" value="[SpectrumID]"/>
            </column>
            <column type="jscolumnspectrumviewer" colspan="5" label="Query" width="550" height="350">
                <!-- <parameter name="file" file="spectra/[internalFilename]"/> -->
                <parameter name="file" file="spectra/specs_ms.mgf"/>
                <parameter name="scan" value="[#Scan#]"/>
                <parameter name="compoundname" value="*..*"/>
            </column>
            <column type="jscolumnspectrumviewer" colspan="5" label="Library" width="550" height="350">
                <parameter name="file" file="lib/[LibraryName]"/>
                <parameter name="spectrumid" value="[SpectrumID]"/>
                <parameter name="compoundname" value="*..*"/>
            </column>

        </row>
    </block>





    <block id="organism_list_DB" type="table">
        <data>
            <source type="file" name="result_specnets_DB/"/>
            <parsers>
                <parser type="groupedTabular" groupBy="Organism"/>
            </parsers>

        </data>
        <row>
            <column type="view" view="organism_details_DB" field="Organism" label="Organism" width="18">
                <parameter name="protein" value="[Organism]"/>
                <parameter name="proteinID" value="[Organism]"/>
            </column>

            <column type="text" field="Organism" label="Organism" width="18"/>
            <column type="integer" field="Hits" label="Hits" width="2"/>
        </row>

    </block>

    <block id="spectra_per_organism_DB" type="table">
        <data>
            <source type="file" name="result_specnets_DB/"/>
            <parsers>
                <parser type="slicedTabular" groupBy="Organism" sliceBy="{protein}"/>
            </parsers>
            <processors>
                <processor type="uploadFilename" field="SpectrumFile"/>
            </processors>

        </data>
        <row>
            <column type="text" field="Compound_Name" label="Compound_Name" width="12"/>
            <column type="integer" field="#Scan#" label="Scan" width="3"/>
            <!--<column type="text" field="SpectrumID" label="SpectrumID" width="15"/>-->
            <column type="text" field="LibraryQualityString" label="Library Class" width="5"/>

            <column type="float" field="MQScore" label="Cosine" precision="2"/>
            <column type="integer" field="SharedPeaks" label="SharedPeaks" width="3"/>
            <column type="float" field="TIC_Query" label="TIC Query" precision="2"/>
            <column type="float" field="RT_Query" label="RT Query" precision="2" />
            <column type="integer" field="MZErrorPPM" label="MZErrorPPM" />
            <column type="text" field="Organism" label="Organism" width="3"/>

            <column type="integer" field="MassDiff" label="MassDiff" width="3"/>
            <column type="float" field="LibMZ" label="LibMZ" precision="2"/>

            <column type="text" field="Instrument" label="Instrument" width="5"/>
            <column type="text" field="IonMode" label="IonMode" width="5"/>
            <column type="text" field="PI" label="PI" width="5"/>
            <column type="text" field="Ion_Source" label="Ion Source" width="5"/>

            <column type="mingplugin" target="/" label="Update">
                <parameter name="workflow" value="[UpdateWorkflowName]"/>
                <parameter name="SPECTRUMID" value="[SpectrumID]"/>
                <parameter name="ADDSPECTRA_LIBQUALITY" value="[Library_Class]"/>
                <parameter name="ADDSPECTRA_IONSOURCE" value="[Ion_Source]"/>
                <parameter name="ADDSPECTRA_INSTRUMENT" value="[Instrument]"/>
                <parameter name="ADDSPECTRA_IONMODE" value="[IonMode]"/>
                <parameter name="ADDSPECTRA_ACQUISITION" value="[Compound_Source]"/>
                <parameter name="ADDSPECTRA_SMILES" value="[Smiles]"/>
                <parameter name="ADDSPECTRA_INCHI" value="[INCHI]"/>
                <parameter name="ADDSPECTRA_INCHIAUX" value="[INCHI_AUX]"/>
                <parameter name="ADDSPECTRA_CASNUMBER" value="[CAS_Number]"/>
                <parameter name="ADDSPECTRA_PUB" value="[Pubmed_ID]"/>
                <parameter name="ADDSPECTRA_PI" value="[PI]"/>
                <parameter name="ADDSPECTRA_DATACOLLECTOR" value="[Data_Collector]"/>
                <parameter name="ADDSPECTRA_EXACTMASS" value="[ExactMass]"/>
                <parameter name="ADDSPECTRA_ADDUCT" value="[Adduct]"/>
                <parameter name="ADDSPECTRA_CHARGE" value="[Charge]"/>
                <parameter name="ADDSPECTRA_MOLECULEMASS" value="[Precursor_MZ]"/>
                <parameter name="ADDSPECTRA_COMPOUND_NAME" value="[Compound_Name]"/>
            </column>
        </row>
        <row expander="image">
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file" file="spectra/[internalFilename]"/>
                <parameter name="scan" value="[#Scan#]"/>
                <parameter name="peptide" value="*..*"/>
                <parameter name="trim" value="true"/>
            </column>
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file" file="lib/[LibraryName]"/>
                <parameter name="spectrumid" value="[SpectrumID]"/>
                <parameter name="peptide" value="*..*"/>
                <parameter name="trim" value="true"/>
            </column>
        </row>

    </block>

    <block id="spectrum_list_specnets" type="table">
        <data>
            <source type="file" name="result_specnets/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="SpectrumFile" operator="ascending"/>
                <parser type="representativeTabular" groupBy="FileScanUniqueID" selectBy="MQScore" operator="max"/>
            </parsers>
            <processors>
                <processor type="uploadFilename" field="SpectrumFile"/>
            </processors>
        </data>
        <row>
            <column type="text" field="SpectrumFile" label="Filename" width="12"/>
            <column type="integer" field="#Scan#" label="Scan" width="3"/>
            <column type="integer" field="Charge" label="Charge" width="1"/>
            <column type="float" field="MQScore" label="Score" precision="5"/>
            <column type="text" field="CompoundName" label="CompoundName" width="18"/>
            <column type="text" field="Organism" label="Organism" width="30"/>
            <column type="integer" field="LibSearchSharedPeaks" label="SharedPeaks" width="2"/>
            <column type="float" field="mzErrorPPM" label="mzErrorPPM" width="5"/>
        </row>
        <row expander="image">
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file" file="spectra/[internalFilename]"/>
                <parameter name="scan" value="[#Scan#]"/>
                <parameter name="peptide" value="[Annotation]"/>
                <parameter name="trim" value="true"/>
            </column>
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file" file="lib/[LibraryName]"/>
                <parameter name="scan" value="[dbIndex]"/>
                <parameter name="peptide" value="[Annotation]"/>
                <parameter name="trim" value="true"/>
            </column>
        </row>
        <row expander="down:up">
            <column type="block" block="results_per_spectrum_specnets" colspan="7">
                <parameter name="spectraid" value="[FileScanUniqueID]"/>
            </column>
        </row>
    </block>

    <block id="results_per_spectrum_specnets" type="table">
        <data>
            <source type="file" name="result_specnets/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="MQScore" operator="ascending"/>
                <parser type="slicedTabular" groupBy="FileScanUniqueID" sliceBy="{spectraid}"/>
            </parsers>
            <processors>
                <processor type="uploadFilename" field="SpectrumFile"/>
            </processors>
        </data>
        <row>
            <column type="text" field="SpectrumFile" label="Filename" width="12"/>
            <column type="integer" field="#Scan#" label="Scan" width="3"/>
            <column type="integer" field="Charge" label="Charge" width="1"/>
            <column type="float" field="MQScore" label="Score" precision="5"/>
            <column type="float" field="FDR" label="FDR" precision="5"/>
            <column type="text" field="CompoundName" label="CompoundName" width="18"/>
            <column type="text" field="Organism" label="Organism" width="30"/>
        </row>
        <row expander="image">
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file" file="spectra/[internalFilename]"/>
                <parameter name="scan" value="[#Scan#]"/>
                <parameter name="peptide" value="[Annotation]"/>
                <parameter name="trim" value="true"/>
            </column>
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file" file="lib/[LibraryName]"/>
                <parameter name="scan" value="[dbIndex]"/>
                <parameter name="peptide" value="[Annotation]"/>
                <parameter name="trim" value="true"/>
            </column>
        </row>
    </block>

    <block id="clusters_list_specnets" type="table">
        <data>
            <source type="file" name="clusterinfosummarygroup_attributes/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="cluster index" operator="ascending"/>
            </parsers>
            <!--                        <processors>
                                <processor type="uploadFilename" field="SpectrumFile"/>
                        </processors>-->
        </data>
        <row>
            <column type="view" view="cluster_details" field="cluster index" label="ClusterIndex" width="18">
                <parameter name="protein" value="[cluster index]"/>
                <parameter name="proteinID" value="[cluster index]"/>
            </column>

            <column type="integer" field="number of spectra" label="NumSpectra" width="3"/>
            <column type="float" field="precursor mass" label="PrecursorMZ" precision="5"/>
            <column type="float" field="sum(precursor intensity)" label="PrecursorInt" precision="5"/>
            <column type="float" field="RTMean" label="RTMean" width="5"/>
            <column type="text" field="AllGroups" label="AllGroups" width="5"/>
            <column type="text" field="DefaultGroups" label="DefaultGroups" width="5"/>
        </row>
        <row expander="image">
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file" file="spectra/specs_ms.mgf"/>
                <parameter name="scan" value="[cluster index]"/>
                <parameter name="peptide" value="*..*"/>
                <parameter name="trim" value="true"/>
            </column>
        </row>

        <row expander="down:up">
            <column type="block" block="related_network_list_specnets" colspan="7">
                <parameter name="spectraid" value="[cluster index]"/>
            </column>
        </row>
    </block>







    <block id="results_per_cluster" type="table">
        <data>
            <source type="file" name="allclustered_spectra_info_withpath/"/>
            <parsers>
                <parser type="slicedTabular" groupBy="cluster index" sliceBy="{protein}"/>
            </parsers>
            <processors>
                <processor type="uploadFilename" field="AllFiles"/>
            </processors>
        </data>
        <row>
            <column type="integer" field="cluster index" label="ClusterIndex" width="3"/>
            <column type="mingplugin" target="/" label="AnnotatetoGNPS">
                <parameter name="workflow" value="ADD-SINGLE-ANNOTATED-BRONZE"/>
                <parameter name="ADDSPECTRA_EXTRACTSCAN" value="[ScanNumber]"/>
                <parameter name="spec_on_server" value="[Original_Path]"/>
            </column>
            <column type="mingplugin" target="/" label="AddtoChallenge">
                <parameter name="workflow" value="ADD-SINGLE-CHALLENGE"/>
                <parameter name="ADDSPECTRA_EXTRACTSCAN" value="[ScanNumber]"/>
                <parameter name="spec_on_server" value="[Original_Path]"/>
            </column>
            <column label="View Metadata" type="genericurlgenerator" width="10">
                <parameter name="URLBASE" value="https://redu.ucsd.edu/datalookup"/>
                <parameter name="REQUESTPARAMETER=filename" value="[Original_Path]"/>
                <parameter name="LABEL" value="View Global Metadata"/>
            </column>
            <column type="text" field="AllFiles" label="Filename" width="10"/>
            <column type="integer" field="ScanNumber" label="Scan" width="3"/>
            <column type="float" field="sum(precursor intensity)" label="Precursor Int" precision="3"/>
            <column type="float" field="RTMean" label="RT" precision="3"/>
            <column type="float" field="parent mass" label="Parent Mass" precision="3"/>

        </row>
        <row expander="View Spectrum" expandericontype="text">
            <column type="jscolumnspectrumviewer" colspan="5" label="Raw Spectrum">
                <parameter name="file" file="[Original_Path]"/>
                <parameter name="scan" value="[ScanNumber]"/>
                <parameter name="peptide" value="*..*"/>
            </column>
            <column type="jscolumnspectrumviewer" colspan="5" label="Consensus Spectrum">
                <parameter name="file" file="spectra/specs_ms.mgf"/>
                <parameter name="scan" value="[cluster index]"/>
                <parameter name="peptide" value="*..*"/>
            </column>
        </row>
        <row expander="MASST Spectrum" expandericontype="text">
            <column type="singlespectrumcolumnhandler" colspan="5">
                <parameter name="mz" value="[parent mass]"/>
                <parameter name="file" file="[Original_Path]"/>
                <parameter name="scan" value="[ScanNumber]"/>
            </column>
        </row>
        <row expander="USI Links" expandericontype="text">
            <column label="USI-Spectrum" type="genericurlgenerator" width="3"> \
                <parameter name="URLBASE" value="https://metabolomics-usi.ucsd.edu/spectrum/"/>\
                <parameter name="REQUESTPARAMETER=usi" value="mzspec:GNPSTASK-{task}:[Original_Path]:scan:[ScanNumber]"/>
                <parameter name="LABEL" value="Spectrum USI"/>
            </column>
        </row>
    </block>

    <!--VIEW NETWORK-->

    <block id="network_list_specnets" type="table">
        <data>
            <source type="file" name="networkedges_display/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="Node1" operator="ascending"/>
                <parser type="representativeTabular" groupBy="Node1" selectBy="Cos_Score" operator="max"/>
            </parsers>
        </data>
        <row>
            <column type="integer" field="Node1" label="Node Index" width="10"/>
        </row>

        <row expander="down:up">
            <column type="block" block="related_network_list_specnets" colspan="7">
                <parameter name="spectraid" value="[Node1]"/>
            </column>
        </row>
    </block>


    <block id="related_network_list_specnets" type="table">
        <data>
            <source type="file" name="networkedges_display/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="Node2" operator="ascending"/>
                <parser type="slicedTabular" groupBy="Node1" sliceBy="{spectraid}"/>
            </parsers>
            <processors>
                <processor type="uploadFilename" field="SpectrumFile"/>
            </processors>
        </data>
        <row>
            <column type="integer" field="Node1" label="Node Index" width="10"/>
            <column type="integer" field="Node2" label="Neighbor Index" width="10"/>
            <column type="float" field="Cos_Score" label="Cosine Score" precision="5" />
            <column type="float" field="MzDiff" label="MzDiff" precision="5"/>
        </row>
        <row expander="image">
            <column type="jscolumnspectrumviewer" colspan="5">
                <parameter name="file" file="[FileName]"/>
                <parameter name="scan" value="[Node1]"/>
                <parameter name="peptide" value="*..*"/>
            </column>
            <column type="jscolumnspectrumviewer" colspan="5">
                <parameter name="file" file="[FileName]"/>
                <parameter name="scan" value="[Node2]"/>
                <parameter name="peptide" value="*..*"/>
            </column>
        </row>
    </block>



    <view id="network_pairs_specnets_allcomponents" label="View Network Pairs All Component" display="hidden">
        <blockRef id="main" type="network_pairs_specnets_allcomponents"/>
    </view>

    <block id="network_pairs_specnets_allcomponents" type="table">
        <data>
            <source type="file" name="networkedges_selfloop/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="CLUSTERID1" operator="ascending"/>
            </parsers>
        </data>
        <row>
            <column type="integer" field="CLUSTERID1" label="Node1" width="10"/>
            <column type="integer" field="CLUSTERID2" label="Node2" width="10"/>
            <column type="float" field="Cosine" label="Cosine Score" precision="5" />
            <column type="float" field="DeltaMZ" label="MzDiff" precision="5"/>
            <column type="integer" field="ComponentIndex" label="ComponentIndex" width="1"/>
        </row>

        <row expander="image">
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file" file="[FileName]"/>
                <parameter name="scan" value="[Node1]"/>
                <parameter name="peptide" value="*..*"/>
                <parameter name="trim" value="true"/>
            </column>
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file" file="[FileName]"/>
                <parameter name="scan" value="[Node2]"/>
                <parameter name="peptide" value="*..*"/>
                <parameter name="trim" value="true"/>
            </column>
        </row>
    </block>

    <view id="network_pairs_specnets_componentsliced" label="View Network Pairs Component Sliced" display="hidden">
        <blockRef id="main" type="network_pairs_specnets_componentsliced"/>
    </view>


    <block id="network_pairs_specnets_componentsliced" type="table">
        <data>
            <source type="file" name="networkedges_selfloop/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="CLUSTERID1" operator="ascending"/>
                <parser type="slicedTabular" groupBy="ComponentIndex" sliceBy="{componentindex}"/>
            </parsers>
        </data>
        <row>
            <column type="integer" field="CLUSTERID1" label="Node1" width="10"/>
            <column type="integer" field="CLUSTERID2" label="Node2" width="10"/>
            <column type="float" field="Cosine" label="Cosine Score" precision="5" />
            <column type="float" field="DeltaMZ" label="MzDiff" precision="5"/>
            <column type="integer" field="ComponentIndex" label="MzDiff" width="1"/>
        </row>

        <row expander="image">
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file" file="[FileName]"/>
                <parameter name="scan" value="[Node1]"/>
                <parameter name="peptide" value="*..*"/>
                <parameter name="trim" value="true"/>
            </column>
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file" file="[FileName]"/>
                <parameter name="scan" value="[Node2]"/>
                <parameter name="peptide" value="*..*"/>
                <parameter name="trim" value="true"/>
            </column>
        </row>
    </block>

    <view id="cluster_info_sliced" label="View Clusters Sliced" display="hidden">
        <blockRef id="main" type="cluster_info_sliced"/>
    </view>


    <block id="cluster_info_sliced" type="table">
        <data>
            <source type="file" name="clusterinfosummarygroup_attributes_withIDs_withcomponentID/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="cluster index" operator="ascending"/>
                <parser type="slicedTabular" groupBy="componentindex" sliceBy="{componentindex}"/>
            </parsers>
        </data>
        <row>
            <column label="ClusterIdx" type="genericurlgenerator" width="10" field="cluster index">
                <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>
                <parameter name="REQUESTPARAMETER=view" value="cluster_details"/>
                <parameter name="REQUESTPARAMETER=protein" value="[cluster index]"/>
                <parameter name="LABEL" value="Cluster - [cluster index]"/>
                <parameter name="USETASK" value="True"/>
            </column>
            <column label="Spec Family" type="genericurlgenerator" width="10" field="componentindex">
                <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>
                <parameter name="REQUESTPARAMETER=view" value="network_displayer"/>
                <parameter name="REQUESTPARAMETER=componentindex" value="[componentindex]"/>
                <parameter name="LABEL" value="View Network"/>
                <parameter name="USETASK" value="True"/>
                <parameter name="IGNORE_VALUE" value="-1"/>
                <parameter name="VALUE_TO_CONSIDER" value="[componentindex]"/>
            </column>
            <column type="parameterlink" target="result.jsp" label="AddToLibrary" includetask="true">
                <parameter name="view" value="cluster_details"/>
                <parameter name="protein" value="[cluster index]"/>
            </column>

            <column type="parameterlink" target="result.jsp" label="+Challenge" includetask="true">
                <parameter name="view" value="cluster_details"/>
                <parameter name="protein" value="[cluster index]"/>
            </column>

            <column type="integer" field="number of spectra" label="NumSpectra" width="3"/>
            <column type="integer" field="UniqueFileSourcesCount" label="NumFiles" width="3"/>
            <column type="float" field="precursor mass" label="PrecursorMZ" precision="5"/>
            <column type="float" field="sum(precursor intensity)" label="PrecursorInt" precision="5"/>
            <column type="float" field="RTMean" label="RTMean" width="3"/>
            <column type="text" field="AllGroups" label="AllGroups" width="3"/>
            <column type="text" field="DefaultGroups" label="DefaultGroups" width="5"/>
            <column type="integer" field="EvenOdd" label="EvenOdd" width="5"/>
            <column type="text" field="LibraryID" label="LibraryID" width="20"/>
            <column type="integer" field="NumberOrganismIDs" label="Hits" width="1"/>
        </row>
        <row expander="image">
            <column type="jscolumnspectrumviewer" colspan="5">
                <parameter name="file" file="spectra/specs_ms.mgf"/>
                <parameter name="scan" value="[cluster index]"/>
                <parameter name="compoundname" value="[LibraryID]"/>
                <parameter name="trim" value="true"/>
            </column>
        </row>


        <row expander="down:up">
            <column type="block" block="related_network_list_specnets" colspan="7">
                <parameter name="spectraid" value="[cluster index]"/>
            </column>
        </row>
    </block>



    <!--
        <view id="powerview" display="hidden">
                <blockRef id="main" type="powerview"/>
        </view>
        <block id="powerview" type="powerview">
            <data>
              <source type="file" name="result/"/>
              <parsers>
                  <parser type="stream" contentType="text/xml"/>
              </parsers>
            </data>
        </block> -->


    <view id="network_displayer" label="Network Display (Alpha)" display="hidden">
        <blockRef id="main" type="network_displayer"/>
    </view>
    <block id="network_displayer" type="network_displayer" display="hidden">
        <data>
            <source type="file" name="result/"/>
            <parsers>
                <parser type="stream" contentType="text/plain"/>
            </parsers>
        </data>
    </block>


    <!-- <view id="task_data_reuse" label="Reanalyze Cluster Spectra" group="Experimental Views">
                <blockRef id="main" type="task_data_reuse"/>
        </view>

        <block id="task_data_reuse" type="task_data_reuse">
            <data>
                <source type="file" name="result/"/>
                <parsers>
                    <parser type="stream" contentType="text/plain"/>
                </parsers>
            </data>
        </block> -->





    <view id="parameters_xml_grabber" label="parameters_xml_grabber" display="hidden">
        <blockRef id="main" type="parameters_xml_grabber"/>
    </view>
    <block id="parameters_xml_grabber" type="stream" panelHeight="600px">
        <data>
            <source type="file" name="params/"/>
            <parsers>
                <parser type="stream" contentType="text/plain"/>
            </parsers>
        </data>
    </block>







    <view id="cytoscape_preview" label="Direct Cytoscape Preview/Download" group="Advanced Views - Experimental Views">
        <blockRef id="main" type="cytoscape_preview"/>
    </view>
    <block id="cytoscape_preview" type="dummylinkout">
        <data>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
        <parameter name="URLBASE" value="http://gnps-cytoscape.ucsd.edu/process?task=[task]"/>
    </block>


    <view id="reanalyze_ms2lda" label="Analyze with MS2LDA" group="Advanced Views - Experimental Views">
        <blockRef id="main" type="reanalyze_ms2lda"/>
    </view>
    <block id="reanalyze_ms2lda" type="dummylinkout">
        <data>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
        <parameter name="URLBASE" value='https://gnps.ucsd.edu/ProteoSAFe/index.jsp?params={"workflow":"MS2LDA_MOTIFDB", "desc":"Reanalysis of Classic Molecular Networking [task] with MS2LDA MotifDB", "spec_on_server":"t.[task]/spectra/specs_ms.mgf", "network_pairs":"t.[task]/networkedges_selfloop/", "MGF_SOURCE":"mscluster"}'/>
    </block>

    <view id="molnetenhancer" label="Enhance with MolNetEnhancer" group="Advanced Views - Experimental Views">
        <blockRef id="main" type="molnetenhancer"/>
    </view>
    <block id="molnetenhancer" type="dummylinkout">
        <data>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
        <parameter name="URLBASE" value='https://gnps.ucsd.edu/ProteoSAFe/index.jsp?params={"workflow":"MOLNETENHANCER", "desc":"Molnetenhancer of Classic Molecular Networking [task]", "GNPS_TASK":"[task]"}'/>
    </block>

    <view id="redu_global_pca" label="Global Comparison with ReDU PCA" group="Advanced Views - Experimental Views">
        <blockRef id="main" type="redu_global_pca"/>
    </view>
    <block id="redu_global_pca" type="dummylinkout">
        <data>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
        <parameter name="URLBASE" value='https://redu.ucsd.edu/processcomparemultivariate?task=[task]'/>
    </block>

    <view id="dereplicator" label="Annotate with DEREPLICATOR" group="Advanced Views - Experimental Views">
        <blockRef id="main" type="dereplicator"/>
    </view>
    <block id="dereplicator" type="dummylinkout">
        <data>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
        <parameter name="URLBASE" value='https://gnps.ucsd.edu/ProteoSAFe/index.jsp?params={"workflow":"DEREPLICATOR", "desc":"DEREPLICATOR of Classic Molecular Networking V2 [task]", "spec_on_server":"t.[task]/spectra/specs_ms.mgf"}'/>
    </block>

    <view id="dereplicatorplus" label="Annotate with DEREPLICATOR+" group="Advanced Views - Experimental Views">
        <blockRef id="main" type="dereplicatorplus"/>
    </view>
    <block id="dereplicatorplus" type="dummylinkout">
        <data>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
        <parameter name="URLBASE" value='https://gnps.ucsd.edu/ProteoSAFe/index.jsp?params={"workflow":"DEREPLICATOR_PLUS", "desc":"DEREPLICATOR+ of Classic Molecular Networking V2 [task]", "spec_on_server":"t.[task]/spectra/specs_ms.mgf"}'/>
    </block>










    <!-- Compound Occurrence -->
    <view id="view_compound_occurrence" label="View Compounds and File Occurrence" group="Advanced Views - Misc Views">
        <blockRef id="main" type="view_compound_occurrence"/>
    </view>

    <block id="view_compound_occurrence" type="table">
        <data>
            <source type="file" name="compound_filename_occurences/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="TotalFiles" operator="ascending"/>
            </parsers>
        </data>
        <row>
            <column type="text" field="LibraryID" label="LibraryID" width="10"/>
            <column type="integer" field="TotalFiles" label="TotalFiles" width="3"/>
        </row>
    </block>



    <!-- Legacy -->
    <view id="view_all_clusters_withID" label="View All Clusters With IDs" group="Legacy Views" display="hidden">
        <blockRef id="main" type="clusters_list_specnets_withID"/>
    </view>
    <block id="clusters_list_specnets_withID" type="table">
        <data>
            <source type="file" name="clusterinfosummarygroup_attributes_withIDs/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="cluster index" operator="ascending"/>
            </parsers>
        </data>
        <row>
            <column type="view" view="cluster_details" field="cluster index" label="ClusterIndex" width="18">
                <parameter name="protein" value="[cluster index]"/>
                <parameter name="proteinID" value="[cluster index]"/>
            </column>

            <column type="parameterlink" target="result.jsp" label="AddToLibrary" includetask="true">
                <parameter name="view" value="cluster_details"/>
                <parameter name="protein" value="[cluster index]"/>
            </column>

            <column type="parameterlink" target="result.jsp" label="+Challenge" includetask="true">
                <parameter name="view" value="cluster_details"/>
                <parameter name="protein" value="[cluster index]"/>
            </column>

            <column type="integer" field="number of spectra" label="NumSpectra" width="3"/>
            <column type="float" field="precursor mass" label="PrecursorMZ" precision="5"/>
            <column type="float" field="sum(precursor intensity)" label="PrecursorInt" precision="5"/>
            <column type="float" field="RTMean" label="RTMean" width="3"/>
            <column type="text" field="AllGroups" label="AllGroups" width="3"/>
            <column type="text" field="DefaultGroups" label="DefaultGroups" width="5"/>
            <column type="text" field="LibraryID" label="LibraryID" width="20"/>
            <column type="integer" field="NumberOrganismIDs" label="Hits" width="1"/>
        </row>
        <row expander="image">
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file" file="spectra/specs_ms.mgf"/>
                <parameter name="scan" value="[cluster index]"/>
                <parameter name="compoundname" value="[LibraryID]"/>
                <parameter name="trim" value="true"/>
            </column>
            <column type="stream" invoke="annotatedSpectrumImageText" contentType="text/plain" colspan="5">
                <parameter name="file" file="spectra/specs_ms.mgf"/>
                <parameter name="scan" value="[cluster index]"/>
                <parameter name="compoundname" value="[LibraryID]"/>
                <parameter name="trim" value="true"/>
            </column>
        </row>


        <row expander="down:up">
            <column type="block" block="related_network_list_specnets" colspan="7">
                <parameter name="spectraid" value="[cluster index]"/>
            </column>
        </row>
    </block>

    <view id="view_qiime2_emperor" label="View qiime2 Emperor Plots" group="Advanced Views - qiime2 Views">
        <blockRef id="main" type="view_qiime2_emperor"/>
    </view>
    <block id="view_qiime2_emperor" type="dummylinkout">
        <data>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>

        <parameter name="URLBASE" value='https://view.qiime2.org/?src=https%3A%2F%2Fcors-anywhere.herokuapp.com%2Fhttps%3A%2F%2Fgnps.ucsd.edu%2FProteoSAFe%2FDownloadResultFile%3Ftask%3D[task]%26file%3Dqiime2_output%252Fqiime2_emperor.qzv%26block%3Dmain'/>
    </block>

    <view id="download_emperor_data" label="Download qiime2 Emperor qzv" group="Advanced Views - qiime2 Views">
        <blockRef id="main" type="download_emperor_data"/>
    </view>

    <block id="download_emperor_data" type="dummydownload">
        <data>
            <source type="file" name="qiime2_output/qiime2_emperor.qzv"/>
            <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
        </data>
    </block>

    <view id="download_qza_table_data" label="Download qiime2 features biom qza" group="Advanced Views - qiime2 Views">
        <blockRef id="main" type="download_qza_table_data"/>
    </view>

    <block id="download_qza_table_data" type="dummydownload">
        <data>
            <source type="file" name="qiime2_output/qiime2_table.qza"/>
            <parsers>
                <parser type="stream" contentType="text/html"/>
            </parsers>
        </data>
    </block>

</interface>
